<!DOCTYPE html>
<html>
<body>
<head>
    <title>Sistema de apoyo a la catalogación de archivos audiovisuales</title>

    <meta charset="utf-8"> <!-- Codificación de la página (permite acentos) -->
    <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Para uso de diseño responsivo con Bootstrap -->
    
    <!-- Latest compiled and minified CSS (Bootstrap)-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <!-- jQuery -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	<!-- Latest compiled and minified JavaScript (Bootstrap)-->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    
    <!-- Script para colpsar/mostrar cada panel/sección del formulario -->
    <script src="js/collapse-panel.js" async></script>
	
	<!-- Script para agregar ayuda en los campos del formulario -->
	<script src="js/popover.js" async></script>

	<!-- (Bootstrap) Form Validator
	Se añade data-toggle="validator" a la etiqueta <form> para habilitar las validaciones
	Se requiere agregar <div class="help-block with-errors"></div> después de cada input/textarea del formulario -->
    <script src="js/validator.min.js" async></script>
</head>

<body>
<?php
include 'Audiovisual.php'; // Clase para representar un audiovisual
?>

<!-- CONEXION CON LA BASE DE DATOS -->
<!-- TODO: Encapsular la lógica de la conexión a la base -->
<?php
$servername = "localhost";
$username = "root";
$password = "advantage7";
$database = "Coleccion_Archivistica";
// NOTA: La manipulación a la base de datos se realiza con PDO (PHP Database Object)
try {
    $conn = new PDO("mysql:host=$servername;dbname=$database", $username, $password);
    $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); // Para manejo de errores con PDO

    $conn->exec("SET NAMES utf8"); // Permite mostrar los resultados con acentos y caracteres extraños
}
catch(PDOException $e) {
    echo "I'm sorry, Dave. I'm afraid I can't do that.<br>"; // :)
    echo "Error: " . $e->getMessage();
}
?>

	<div class="container">
		<div class="page-header">
			<h1>Editar audiovisual</h1>
		</div>

		<!-- Realizar consulta en la base de acuerdo al id (código de identificación) -->
		<?php
		$select = "SELECT * FROM area_de_identificacion WHERE codigo_de_referencia = '" . $_GET['id'] . "'";
	    $stmt = $conn->prepare($select);
	    $stmt->execute();
	    $stmt->setFetchMode(PDO::FETCH_ASSOC); // Establecer fetch mode (arreglo asociativo con nombres de columnas de la base)
	    // Check if id is in database (for develop purpose only)
	    if ($stmt->rowCount() == 0){
	    	echo '<pre>It not works!</pre>';
	    } else {
	    	echo '<pre>It works!</pre>';
	    	$data = $stmt->fetch(); // Obtener el único resultado de la base de datos
	    	$av = new Audiovisual($data); // Crear el objeto Audiovisual a partir de la información de la base
	    }
		?>

		<form role="form" id="audiovisualForm" method="POST" data-toggle="validator"> <!-- Se omite action="another.php" para que la acción se ejecute en este documento -->

			<!-- El código de identificación es el único campo no-editable -->
			<div class="form-group">
				<label for="codigo_de_referencia">Código de identificación:</label>
				<input class="form-control" name="codigo_de_referencia" id="codigo_de_referencia" value="<?php echo $_GET['id'];?>" readonly>
			</div>

			<!-- Todos los campos input son por default texto: type="text" -->
			<div class="panel panel-default">
				<div class="panel-heading">Área de identificación</div>
				<div class="panel-body collapse">
					<div class="form-group control-group">
						<label for="titulo_propio">Título propio</label>
						<input class="form-control" autofocus id="titulo_propio" name="titulo_propio" value="<?php echo (isset($av->titulo_propio)) ? $av->titulo_propio : ''; ?>" maxlength="120">
						<div class="help-block with-errors"></div>
					</div>
					<div class="form-group control-group">
						<label for="titulo_paralelo">Título paralelo</label>
						<input class="form-control" id="titulo_paralelo" name="titulo_paralelo" value="<?php echo (isset($av->titulo_paralelo)) ? $av->titulo_paralelo : ''; ?>" maxlength="120">
						<div class="help-block with-errors"></div>
					</div>
					<div class="form-group control-group">
						<label for="titulo_atribuido">Título atribuido</label>
						<input class="form-control" id="titulo_atribuido" name="titulo_atribuido" value="<?php echo (isset($av->titulo_atribuido)) ? $av->titulo_atribuido : ''; ?>" maxlength="120">
						<div class="help-block with-errors"></div>
					</div>
					<div class="form-group">
						<label for="titulo_de_serie">Título de la serie</label>
						<input class="form-control" id="titulo_de_serie" name="titulo_de_serie" value="<?php echo (isset($av->titulo_de_serie)) ? $av->titulo_de_serie : ''; ?>" maxlength="70">
						<div class="help-block with-errors"></div>
					</div>
					<div class="form-group">
						<label for="numero_de_programa">Número de programa</label>
						<input class="form-control" id="numero_de_programa" name="numero_de_programa" value="<?php echo (isset($av->numero_de_programa)) ? $av->numero_de_programa : ''; ?>" maxlength="">
					</div>
					<div class="form-group">
						<label for="pais">País</label>
						<input class="form-control" id="pais" name="pais" value="<?php echo (isset($av->pais)) ? $av->pais : ''; ?>" maxlength="">
					</div>
					<div class="form-group">
						<label for="fecha">Fecha</label>
						<input class="form-control" id="fecha" name="fecha" type="number" min="1890" max="2019" value="<?php echo (isset($av->fecha)) ? $av->fecha : ''; ?>" maxlength="">
					</div>
					<div class="form-group">
						<label for="duracion">Duración</label>
						<input class="form-control" id="duracion" name="duracion" placeholder="HH:MM:SS" value="<?php echo (isset($av->duracion)) ? $av->duracion : ''; ?>" maxlength="">
					</div>
					<div class="form-group">
						<label for="investigacion">Investigación</label>
						<input class="form-control" id="investigacion" name="investigacion" value="<?php echo (isset($av->investigacion)) ? $av->investigacion : ''; ?>">
					</div>
					<div class="form-group">
						<label for="realizacion">Realización</label>
						<input class="form-control" id="realizacion" name="realizacion" value="<?php echo (isset($av->realizacion)) ? $av->realizacion : ''; ?>">
					</div>
					<div class="form-group">
						<label for="direccion">Dirección</label>
						<input class="form-control" id="direccion" name="direccion" value="<?php echo (isset($av->direccion)) ? $av->direccion : ''; ?>">
					</div>
					<div class="form-group">
						<label for="guion">Guión</label>
						<input class="form-control" id="guion" name="guion" value="<?php echo (isset($av->guion)) ? $av->guion : ''; ?>">
					</div>
					<div class="form-group">
						<label for="adaptacion">Adaptación</label>
						<input class="form-control" id="adaptacion" name="adaptacion" value="<?php echo (isset($av->adaptacion)) ? $av->adaptacion : ''; ?>">
					</div>
					<div class="form-group">
						<label for="idea_original">Idea original</label>
						<input class="form-control" id="idea_original" name="idea_original" value="<?php echo (isset($av->idea_original)) ? $av->idea_original : ''; ?>">
					</div>
					<div class="form-group">
						<label for="fotografia">Fotografía</label>
						<input class="form-control" id="fotografia" name="fotografia" value="<?php echo (isset($av->fotografia)) ? $av->fotografia : ''; ?>">
					</div>
					<div class="form-group">
						<label for="fotografia_fija">Fotografía fija</label>
						<input class="form-control" id="fotografia_fija" name="fotografia_fija" value="<?php echo (isset($av->fotografia_fija)) ? $av->fotografia_fija : ''; ?>">
					</div>
					<div class="form-group">
						<label for="edicion">Edición</label>
						<input class="form-control" id="edicion" name="edicion" value="<?php echo (isset($av->edicion)) ? $av->edicion : ''; ?>">
					</div>
					<div class="form-group">
						<label for="sonido_grabacion">Grabación de sonido</label>
						<input class="form-control" id="sonido_grabacion" name="sonido_grabacion" value="<?php echo (isset($av->sonido_grabacion)) ? $av->sonido_grabacion : ''; ?>">
					</div>
					<div class="form-group">
						<label for="sonido_edicion">Edición de sonido</label>
						<input class="form-control" id="sonido_edicion" name="sonido_edicion" value="<?php echo (isset($av->sonido_edicion)) ? $av->sonido_edicion : ''; ?>">
					</div>
					<div class="form-group">
						<label for="musica_original">Música original</label>
						<input class="form-control" id="musica_original" name="musica_original" value="<?php echo (isset($av->musica_original)) ? $av->musica_original : ''; ?>">
					</div>
					<div class="form-group">
						<label for="musicalizacion">Musicalización</label>
						<input class="form-control" id="musicalizacion" name="musicalizacion" value="<?php echo (isset($av->musicalizacion)) ? $av->musicalizacion : ''; ?>">
					</div>
					<div class="form-group">
						<label for="voces">Voces</label>
						<input class="form-control" id="voces" name="voces" value="<?php echo (isset($av->voces)) ? $av->voces : ''; ?>">
					</div>
					<div class="form-group">
						<label for="actores">Actores</label>
						<input class="form-control" id="actores" name="actores" value="<?php echo (isset($av->actores)) ? $av->actores : ''; ?>">
					</div>
					<div class="form-group">
						<label for="animacion">Animación</label>
						<input class="form-control" id="animacion" name="animacion" value="<?php echo (isset($av->animacion)) ? $av->animacion : ''; ?>">
					</div>
					<div class="form-group">
						<label for="otros_colaboradores">Otros colaboradores</label>
						<input class="form-control" id="otros_colaboradores" name="otros_colaboradores" value="<?php echo (isset($av->otros_colaboradores)) ? $av->otros_colaboradores : ''; ?>">
					</div>					 
				</div>
			</div>

			<div class="panel panel-default">
				<div class="panel-heading">Área de contexto</div>
				<div class="panel-body collapse">
					<div class="form-group">
						<label for="entidad_productora">Entidad productora</label>
						<input class="form-control" id="entidad_productora" name="entidad_productora">
					</div>
					<div class="form-group">
						<label for="productor">Productor</label>
						<input class="form-control" id="productor" name="productor">
					</div>
					<div class="form-group">
						<label for="distribuidora">Distribuidora</label>
						<input class="form-control" id="distribuidora" name="distribuidora">
					</div>
					<div class="form-group">
						<label for="historia_institucional">Historia institucional</label>
						<textarea class="form-control" rows="4" id="historia_institucional" name="historia_institucional"></textarea>
					</div>
					<div class="form-group">
						<label for="resena_biografica">Reseña biográfica</label>
						<textarea class="form-control" rows="4" id="resena_biografica" name="resena_biografica"></textarea>
					</div>
					<div class="form-group">
						<label for="forma_de_ingreso">Forma de ingreso</label>
						<input class="form-control" id="forma_de_ingreso" name="forma_de_ingreso" list="formaDeIngreso">
					</div>
					<div class="form-group">
						<label for="fecha_de_ingreso">Fecha de ingreso</label>
						<input class="form-control" id="fecha_de_ingreso" name="fecha_de_ingreso" type="date">
					</div>
				</div>
			</div>

			<div class="panel panel-default">
				<div class="panel-heading">Área de contenido y estructura</div>
				<div class="panel-body collapse">
					<div class="form-group">
						<label for="sinopsis">Sinopsis</label>
						<textarea class="form-control" rows="4" id="sinopsis" name="sinopsis"></textarea>
					</div>
					<div class="form-group">
						<label for="descriptor_onomastico">Descriptor onomástico</label>
						<input class="form-control" id="descriptor_onomastico" name="descriptor_onomastico">
					</div>
					<div class="form-group">
						<label for="descriptor_toponimico">Descriptor toponímico</label>
						<textarea class="form-control" rows="2" id="descriptor_toponimico" name="descriptor_toponimico"></textarea>
					</div>
					<div class="form-group">
						<label for="descriptor_cronologico">Descriptor cronológico</label>
						<input class="form-control" id="descriptor_cronologico" name="descriptor_cronologico">
					</div>
					<div class="form-group">
						<label for="tipo_de_produccion">Tipo de producción</label>
						<input class="form-control" id="tipo_de_produccion" name="tipo_de_produccion" list="tipoDeProduccion">
					</div>
					<div class="form-group">
						<label for="genero">Género</label>
						<input class="form-control" id="genero" name="genero">
					</div>
					<div class="form-group">
						<label for="fuentes">Fuentes</label>
						<input class="form-control" id="fuentes" name="fuentes" list="fuentesDatalist">
					</div>
					<div class="form-group">
						<label for="recursos">Recursos</label>
						<input class="form-control" id="recursos" name="recursos" list="recursosDatalist">
					</div>
					<div class="form-group">
						<label for="versiones">Versiones</label>
						<input class="form-control" id="versiones" name="versiones">
					</div>
					<div class="form-group">
						<label for="formato_original">Formato original</label>
						<input class="form-control" id="formato_original" name="formato_original">
					</div>
					<div class="form-group">
						<label for="material_extra">Material extra</label>
						<input class="form-control" id="material_extra" name="material_extra">
					</div>
				</div>
			</div>

			<div class="panel panel-default">
				<div class="panel-heading">Área de condiciones de acceso</div>
				<div class="panel-body collapse">
					<div class="form-group">
						<label for="condiciones_de_acceso">Condiciones de acceso</label>
						<input class="form-control" id="condiciones_de_acceso" name="condiciones_de_acceso" list="condicionesDeAcceso">
					</div>
					<div class="form-group">
						<label for="existencia_y_localizacion_de_originales">Existencia y localizacion de originales</label>
						<input class="form-control" id="existencia_y_localizacion_de_originales" name="existencia_y_localizacion_de_originales">
					</div>
					<div class="form-group">
						<label for="idioma_original">Idioma original</label>
						<input class="form-control" id="idioma_original" name="idioma_original">
					</div>
					<div class="form-group">
						<label for="doblajes_disponibles">Doblajes disponibles</label>
						<input class="form-control" id="doblajes_disponibles" name="doblajes_disponibles">
					</div>
					<div class="form-group">
						<label for="subtitulajes">Subtitulajes disponibles</label>
						<input class="form-control" id="subtitulajes" name="subtitulajes">
					</div>
					<div class="form-group">
						<label for="soporte">Soporte</label>
						<input class="form-control" id="soporte" name="soporte">
					</div>
					<div class="form-group">
						<label for="numero_copias">Número de copias</label>
						<input class="form-control" id="numero_copias" name="numero_copias" type="number" min="0">
					</div>
					<div class="form-group">
						<label for="descripcion_fisica">Descripción física</label>
						<textarea class="form-control" rows="2" id="descripcion_fisica" name="descripcion_fisica"></textarea>
					</div>
					<div class="form-group">
						<label for="color">Color</label>
						<input class="form-control" id="color" name="color">
					</div>
					<div class="form-group">
						<label for="audio">Audio</label>
						<input class="form-control" id="audio" name="audio">
					</div>
					<div class="form-group">
						<label for="sistema_de_grabacion">Sistema de grabación</label>
						<input class="form-control" id="sistema_de_grabacion" name="sistema_de_grabacion">
					</div>
					<div class="form-group">
						<label for="region_dvd">Región del DVD</label>
						<input class="form-control" id="region_dvd" name="region_dvd">
					</div>
					<div class="form-group">
						<label for="requisitos_tecnicos">Requisitos técnicos</label>
						<input class="form-control" id="requisitos_tecnicos" name="requisitos_tecnicos">
					</div>
				</div>
			</div>

			<div class="panel panel-default">
				<div class="panel-heading">Área de documentación asociada</div>
				<div class="panel-body collapse">
					<div class="form-group">
						<label for="existencia_y_localizacion_de_copias">Existencia y localización de copias</label>
						<input class="form-control" id="existencia_y_localizacion_de_copias" name="existencia_y_localizacion_de_copias">
					</div>
					<div class="form-group">
						<label for="unidades_de_descripcion_relacionadas">Unidades de descripción relacionadas</label>
						<textarea class="form-control" rows="2" id="unidades_de_descripcion_relacionadas" name="unidades_de_descripcion_relacionadas"></textarea>
					</div>
					<div class="form-group">
						<label for="documentos_asociados">Documentos asociados</label>
						<textarea class="form-control" rows="2" id="documentos_asociados" name="documentos_asociados"></textarea>
					</div>
				</div>
			</div>

			<div class="panel panel-default">
				<div class="panel-heading">Área de notas</div>
				<div class="panel-body collapse">
					<div class="form-group">
						<label for="area_de_notas">Área de notas</label>
						<textarea class="form-control" rows="4" id="area_de_notas" name="area_de_notas"></textarea>
					</div>
				</div>
			</div>

			<div class="panel panel-default">
				<div class="panel-heading">Área de descripción</div>
				<div class="panel-body collapse">
					<div class="form-group">
						<label for="notas_del_archivero">Notas del archivero</label>
						<textarea class="form-control" rows="2" id="notas_del_archivero" name="notas_del_archivero"></textarea>
					</div>
					<div class="form-group">
						<label for="datos_del_archivero">Datos del archivero</label>
						<input class="form-control" id="datos_del_archivero" name="datos_del_archivero">
					</div>
					<div class="form-group">
						<label for="reglas_o_normas">Reglas o normas</label>
						<input class="form-control" id="reglas_o_normas" name="reglas_o_normas">
					</div>
					<div class="form-group">
						<label for="fecha_de_descripcion">Fecha de descripción</label>
						<input class="form-control" id="fecha_de_descripcion" name="fecha_de_descripcion" type="date" value="<?php echo date('Y-m-d'); ?>" readonly>
					</div>
				</div>
			</div>

			<button type="submit" class="btn btn-default">Enviar</button> 
		</form>
	</div>

<!-- Datalists utilizados en los campos -->
<datalist id="formaDeIngreso">
	<option value="Compra">
	<option value="Donación">
	<option value="Producción propia">
</datalist>

<datalist id="tipoDeProduccion">
	<option value="Película de ficción">
	<option value="Película documental">
	<option value="Programa de televisión">
	<option value="Trailer">
	<option value="Publicidad">
	<option value="Propaganda">
	<option value="Registros fílmicos">
	<option value="Registros en video">
	<option value="Extractos de otras producciones">
</datalist>

<datalist id="recursosDatalist">
	<option value="Entrevistas">
	<option value="Grabación de campo">
	<option value="Puesta en escena">
	<option value="Animación">
	<option value="Fotografía">
	<option value="Pintura">
	<option value="Grabados">
	<option value="Cartografía">
	<option value="Testimonios orales">
	<option value="Testimonios video orales">
	<option value="Videoclips">
	<option value="Dibujo">
	<option value="Multimedia">
	<option value="Insidentales">
	<option value="Voz en off">
	<option value="Narración">
	<option value="Conducción">
	<option value="Interactividad">
</datalist>

<datalist id="fuentesDatalist">
	<option value="Animación">
	<option value="Ficción">
	<option value="Documental">
	<option value="Registros fílmicos">
	<option value="Fotografía">
	<option value="Pintura">
	<option value="Otros gráficos">
	<option value="Grabados">
	<option value="Hemerografía">
	<option value="Cartografía">
	<option value="Testimonios orales">
	<option value="Testimonios video orales">
	<option value="Noticieros fílmicos">
	<option value="Programas de TV">
	<option value="Publicidad">
	<option value="Videoclips">
	<option value="Dibujo">
	<option value="Multimedia">
	<option value="Registros fonográficos">
	<option value="Música de época">
	<option value="Documentos">
	<option value="Registros radiofónicos">
	<option value="Registros videográficos">
</datalist>

<datalist id="condicionesDeAcceso">
	<option value="Usos no lucrativos">
	<option value="Usos reservados para consulta in situ">
</datalist>

</body>
</html>